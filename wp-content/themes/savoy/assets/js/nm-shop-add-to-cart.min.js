/* NM: Add-to-cart script */
'use strict';(function(c){c.extend(c.nmTheme,{atc_init:function(){this.atcBind()},atcBind:function(){var d=this;d.$body.on("click",".single_add_to_cart_button",function(b){var a=c(this);if(a.is(".disabled"))console.log("NM: Add-to-cart button disabled");else if(a.hasClass("nm-simple-add-to-cart-button")||a.hasClass("nm-variable-add-to-cart-button"))b.preventDefault(),d.quickviewOpen=d.quickviewIsOpen(),d.quickviewOpen&&a.addClass("nm-loader nm-loader-light"),a.attr("disabled","disabled"),b=a.closest("form"),
b.length&&(b={product_id:b.find("[name*='add-to-cart']").val(),product_variation_data:b.serialize()},d.$body.trigger("adding_to_cart",[a,b]),d.atcAjaxSubmitForm(a,b))})},atcAjaxSubmitForm:function(d,b){var a=this;if(b.product_id){if("undefined"!==typeof wc_add_to_cart_params)var g=wc_add_to_cart_params.wc_ajax_url;else console.log('NM: "wc_add_to_cart_params" undefined - WooCommerce AJAX atc disabled'),g=nm_wp_vars.woocommerceAjaxUrl;g=g.toString().replace("wc-ajax=%%endpoint%%","add-to-cart="+b.product_id+
"&nm-ajax-add-to-cart=1");c.ajax({type:"POST",url:g,data:b.product_variation_data,dataType:"html",cache:!1,headers:{"cache-control":"no-cache"},error:function(e,f,h){console.log("NM: AJAX error - atcAjaxSubmitForm() - "+h)},success:function(e){e=c("<div>"+e+"</div>");var f=e.find("#nm-shop-notices-wrap"),h=f.find(".woocommerce-error").length?!0:!1;f={".nm-menu-cart-count":e.find(".nm-menu-cart-count").prop("outerHTML"),"#nm-shop-notices-wrap":f.prop("outerHTML"),"#nm-cart-panel":e.find("#nm-cart-panel").prop("outerHTML")};
a.shopReplaceFragments(f);a.$body.trigger("added_to_cart",[f,"",d]);a.quickviewOpen?(c.magnificPopup.close(),h?a.isShop&&a.shopScrollToTop():a.$widgetPanel.length&&setTimeout(function(){a.widgetPanelShow(!1,!0)},350)):(d.removeAttr("disabled"),h&&setTimeout(function(){c("#nm-widget-panel-overlay").trigger("click");a.isShop&&a.shopScrollToTop()},500));e.empty()}})}else console.log("NM (Error): No product id found")}});c.nmThemeExtensions.add_to_cart=c.nmTheme.atc_init})(jQuery);